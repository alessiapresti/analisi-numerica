PROGRAM GAUSS 
REAL A (101,101),SOMMA,L(100,100),U(100,100),DET
INTEGER N
PRINT *, 'INSERISCI IL GRADO DEL SISTEMA:'
READ *, N 
DO I = 1, N 
        DO J = 1, N 
                PRINT*,'A(',I,',',J,')='
                READ*,A(I,J)
        END DO
END DO
DO I=1,N
        PRINT*,'B(',I,')='
! B(I)=A(I,N+1)
        READ*,A(I,N+1)
END DO
! MI FACCIO RISCRIVERE LA MATRICE DI PARTENZA ORLATA CON B
DO I=1,N
        PRINT*,(A(I,J),J=1,N),'|',A(I,N+1)
END DO
PRINT*, '---------------------------------------------------------------------'
! J è L'INDICE DI COLONNA
DO J=1,N-1
! I è L'INDICE DI RIGA
        DO I=J+1,N
        ! I MOLTIPLICATORI M(I,J)=A(I,J)
                A(I,J)=A(I,J)/A(J,J) ! M(I,J)=A(I,J)/A(J,J)
                ! K è L'INDICE CHE MI PERMETTE DI MODIFICARE GLI ALTRI VALORI 
                ! RIMANENTI CHE NON SIANO GIà STATI RISCRITTI DAI MOLTIPLICATORI
                ! IL CICLO K VA MESSO INTERNAMENTE PERCHè PRIMA DI POTER 
                ! MODIFICARE GLI ALTRI ELEMENTI HO BISOGNO DI DEFINIRE I 
                ! MOLTIPLICATORI
                DO K=J+1,N
                        A(I,K)=A(I,K)-A(I,J)*A(J,K)
                        ! L'ELEMENTO A(I,K) QUINDI DI RIGA I E DI COLONNA K
                        ! GLI ASSEGNO IL NUOVO VALORE, CHE SAREBBE UGUALE AD
                        ! A(I,K) STESSO MENO IL PRODOTTO TRA IL
                        ! CORRISPONDENTE MOLTIPLICATORE DELLA RIGA I-ESIMA
                        ! AL PASSO J-ESIMO, E QUINDI M(I,J)=A(I,J), E 
                        ! L'ELEMENTO DELLA STESSA COLONNA CHE PERò HA COME 
                        ! RIGA LA STESSA DEL PASSO CHE STIAMO EFFETTUANDO 
                        ! NEL CICLO PIù ESTERNO, OVVERO LA COLONNA 
                        ! CORRISPONDENTE ALLA QUALE STIAMO CALCOLANDO I 
                        ! RISPETTIVI MOLTIPLICATORI
                END DO
                A(I,N+1)=A(I,N+1)-A(I,J)*A(J,N+1)
                ! I TERMINI NOTI, CIOè LE B(I)=A(I,N+1) VANNO MODIFICATI 
                ! ANCH'ESSI PASSO PER PASSO, IN PARTICOLARE PRENDENDO I VALORI 
                ! INIZIALI DEL PASSO PRECEDENTE E SOTTRAENDOGLI IL PRODOTTO
                ! TRA IL MOLTIPLICATORE DELLA RIGA E DEL PASSO CORRISPONDENTE
                ! E IL TERMINE NOTO AVENTE COME TERMINE DI RIGA LO STESSO 
                ! DEL PASSO, CIOè B(J)=A(J,N+1)
        END DO
END DO
DO I=1,N
        PRINT*,(A(I,J),J=1,N),'|',A(I,N+1)
        ! MI FACCIO RISCRIVERE LA MATRICE A I CUI VALORI SONO STATI MODIFICATI
        ! DAL CICLO PRECEDENTE, ATTENZIONE PERò CHE I TERMINI SOTTO LA 
        ! DIAGONALE PRINCIPALE CORRISPONDONO AI MOLTIPLICATORI, MENTRE
        ! GLI ELEMENTI DALLA DIAGONALE PRINCIPALE IN SU SONO GLI ELEMENTI 
        ! DELLA NUOVA MATRICE A DOPO AVER FATTO TUTTE LE OPERAZIONE CHE
        ! MI PERMETTONO DI LASCIARE INVARIATO IL SISTEMA, OVVIAMENTE 
        ! L'ULTIMA COLONNA CORRISPONDE AL VETTORE DEI TERMINI NOTI
        ! ANCH'ESSI OPPORTUNAMENTE MODIFICATI
END DO
PRINT*,'----------------------------------------------------------------------'
DO I=1,N
        DO J=I,N
                L(I,J)=0
                U(I,J)=0
                ! MI DEFINISCO LE DUE NUOVE MATRICI ASSEGNANDOGLI A TUTTI I    
                ! LORO VALORI 0, CHE MI SERVIRANNO PER VISUALIZZARE LA MATRICE 
                ! U E LA MATRICE L TALI CHE A=L*U
        END DO
END DO
DO I=1,N
! I INDICE DI RIGA
        DO J=I,N
        ! J INDICE DI COLONNA
                U(I,J)=A(I,J)
        END DO
END DO
DO J=1,N-1
! J INDICE DI COLONNA
        DO I=J+1,N
        ! I INDICE DI RIGA
                L(I,J)=-A(I,J)
        END DO
        L(J,J)=1
        ! MI SERVE POICHé LA MATRICE L è UNA MATRICE TRIANGOLA INFERIORE
        ! IN PARTICOLARE AVENTE TUTTI 1 SULLA DIAGONALE PRINCIPALE
END DO
PRINT*,'LA MATRICE U è:'
DO I=1,N
        PRINT*,(U(I,J),J=1,N)
END DO
PRINT*,'----------------------------------------------------------------------'
PRINT*,'LA MATRICE L è:'
DO I=1,N
        PRINT*,(L(I,J),J=1,N)
END DO
PRINT*,'----------------------------------------------------------------------'
DET=1
DO I=1,N
        DET=DET*A(I,I)
        ! IL DETERMINANTE OVVIAMENTE NON è ALTRO CHE IL PRODOTTO DEI TERMINI
        ! CHE SI TROVANO SULLA DIAGONALE PRINCIPALE DELLA NUOVA MATRICE A
END DO
PRINT*,'DET(A)=',DET
PRINT*,'----------------------------------------------------------------------'
PRINT*,'LE SOLUZIONI DEL SISTEMA SONO:'
DO J=N,1,-1
! INDICA LA COLONNA DA CUI STIAMO PARTENDO, DOBBIAMO PARTIRE DALL'ULTIMA 
! POICHè DOBBIAMO SFRUTTARE LE SOSTITUZIONI ALL'INDIETRO, ESSENDO CHE IL 
! NUOVO SISTEMA è TRIANGOLARE SUPERIORE
        SOMMA=0
        ! DEFINISCO LA SOMMA DEI TERMINI CHE SI GENERANO NEL MOMENTO IN CUI
        ! VADO A FARE LA SOSTITUZIONE ALL'INDIETRO
        ! LA INIZIALIZZO OGNI VOLTA POICHè DOPO OGNI PASSO SI RIFERISCE 
        ! A UNA RIGA DIVERSA
        DO I=J+1,N
               SOMMA=SOMMA+A(J,I)*A(I,I) 
        END DO
        A(J,J)=(A(J,N+1)-SOMMA)/A(J,J)
        ! CI RICAVIAMO INDUTTIVAMENTE CHE IL L'INCOGNITA X_J=A(J,J) SARà UGUALE
        ! AL TERMINE NOTO B(J)=A(J,N+1) DELLA RIGA CORRISPONDENTE MENO 
        ! LA SOMMA DEI TERMINI NOTI CHE CI SIAMO TROVATI NEL MOMENTO IN CUI
        ! ABBIAMO TROVATO LE SOLUZIONE SUCCESSIVE ALLA X_J, TUTTO FRATTO 
        ! OVVIAMENTE IL COEFFICENTE DELLA X_J CHE CORRISPONDEREBBE ESATTAMENTE
        ! A A(J,J), SI RICAVA FACILMENTE OSSERVANDO IL NUOVO SISTEMA
        ! (HO SOVRASCRITTO LA SOLUZIONE X_J SUL TERMINE A(J,J) PER UNA 
        ! SEMPLICE QUESTIONE DI SPAZIO DI MEMORIA, SE A NOI INTERESSASSE
        ! SOLTANTO TROVARE LE SOLUZIONI, LA COSA ANDREBBE BENISSIMO COSì,
        ! SE ALTERNATIVAMENTE CI VOLESSI FARE QUALCOS ALTRO CON LA MATRICE,
        ! MI BASTEREBBE DEFINIRE UN VETTORE X DI N COMPONENTI E SOSTITUIRE 
        ! ALL'INTERNO DEL CODICE A(J,J) CON X(J))
END DO
PRINT*,'[',(A(I,I),I=1,N),']'
! INFINE MI FACCIO VISUALIZZARE A VIDEO LE SOLUZIONI CHE RICORDIAMO AVEVAMO 
! SOVRASCRITTO ALLE A(I,I)
END
